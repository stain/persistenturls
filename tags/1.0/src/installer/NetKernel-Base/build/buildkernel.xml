<?xml version="1.0" encoding="UTF-8"?>
<!--
******************************************
1060 NetKernel Build Ant Script v1.0
(C) 2003 1060 Research Ltd.

Builds 1060NetKernel-xxx.jar, javadoc etc
******************************************
-->
<project basedir="." default="all" name="1060netkernel">
	
	<target name="init">
        <property name="app" value="1060netkernel"/>
        <property name="version" value="2.8.4"/>
        <property name="lib" value="../lib"/>
		<property name="src" value="../src/kernel"/>
		<property name="dst" value="./kernel"/>
		<mkdir dir="${dst}"/>
		<mkdir dir="${dst}/class"/>
		<mkdir dir="${dst}/docs"/>
    </target>
    
    <target depends="init" name="compile-kernel">
        <javac debug="true" deprecation="true" destdir="${dst}/class" srcdir="${src}">
            <classpath>
				<pathelement location="${lib}/xalan.jar"/>
				<pathelement location="${lib}/xml-apis.jar"/>
				<pathelement location="${lib}/xercesImpl.jar"/>
            </classpath>
        </javac>
    </target>
	
    <target depends="init,compile-kernel, kernel-package" name="jar-kernel">
        <jar basedir="${dst}/class" compress="true" jarfile="${app}-${version}.jar">
		<include name="com"/>
		<include name="**/*.class"/>
		<include name="**/*.xml"/>
		<exclude name="**/*.java~"/>
		<exclude name="**/*.form"/>
		<exclude name="**/*.zip"/>
		<exclude name="**/*.exe"/>
		<exclude name="**/*.sh"/>
		<exclude name="${app}.mf"/>
		<exclude name="**/*.jar"/>
		<exclude name="./package"/>
		<exclude name="./shell_scripts"/>
		<exclude name="apidoc"/>
        </jar>
    </target>
	
	<target depends="init,compile-kernel" name="kernel-package">
		<delete dir="${dst}/*"/>
		<copy todir="${dst}/class">
			<fileset dir="${src}">
				<include name="**/system.xml"/>
			</fileset>
		</copy>
	</target>
	
    <target depends="init,clean, build-kernel, javadoc" description="Build everything." name="all">
        <echo message="${app}  built."/>
    </target>
	
	<target depends="init,clean,compile-kernel,jar-kernel" description="Build kernel." name="build-kernel">
        <echo message="${app} built."/>
    </target>
		
    <target depends="init" description="Clean all build products." name="clean">
        <delete>
            <fileset dir="${dst}">
                <include name="**/*.class"/>
            </fileset>            
        </delete>
		<delete file="${app}-${version}.jar"/>
        <delete dir="${dst}/docs"/>
    </target>
	
	<target depends="init" description="Generate Javadoc" name="javadoc">
		<javadoc	packagenames="com.ten60.*"
					sourcepath="${src}"
					destdir="${dst}/docs"
					author="false"
					version="true"
					verbose="false"
					use="true"
					windowtitle="1060 NetKernel API">
				<doctitle><![CDATA[<h1>1060 NetKernel v2.0.0</h1>]]></doctitle>
				<bottom><![CDATA[<i>Copyright &#169; 2002-2003 1060 Research Limited. Licensed under 1060 Public License v1.0. All Rights Reserved.</i>]]></bottom>				
		  </javadoc>
	</target>

</project>
